<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of plot_sem_2d</title>
  <meta name="keywords" content="plot_sem_2d">
  <meta name="description" content="PLOT_SEM_2D Plots SEM numerical solution of 2D boundary value problems">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="#">Src</a> &gt; <a href="index.html">Level_2</a> &gt; plot_sem_2d.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for Src/Level_2&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>plot_sem_2d
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>PLOT_SEM_2D Plots SEM numerical solution of 2D boundary value problems</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function [ha]=plot_sem_2d(fig,command,nex,ney,x,xx,jacx,y,yy,jacy,xy,ww,nov,u,n_int); </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> PLOT_SEM_2D Plots SEM numerical solution of 2D boundary value problems

  [ha]=plot_sem_2d(fig,command,nex,ney,x,xx,jacx,y,yy,jacy,xy,ww,nov,...
    u,n_int);

 Input: fig =  figure number, set in the colling function by figure
                command
        command = either 'mesh', 'surf' or 'contour'
        nex = number of Spectral elements along x-direction
        ney = number of Spectral elements along y-direction
        x = LGL nodes in [-1,1] along x-direction
        xx = 2-indexes array of size (4,ne) 
            xx(1:4,ie)=[x_V1_ie;x_V2_ie;x_V3_ie;x_V4_ie]
            (ne=nex*ney is the global number of spectral elements)
        jacx = array (length(jacx)=ne); jacx(ie)= (x_V2_ie-x_V1_ie)/2
        y = LGL nodes in [-1,1] along y-direction
        yy = 2-indexes array of size (4,ne)
            yy(1:4,ie)=[y_V1_ie;y_V2_ie;y_V3_ie;y_V4_ie]
            (ne=nex*ney is the global number of spectral elements)
        jacy = array (length(jacy)=ne); jacy(ie)= (y_V3_ie-y_V1_ie)/2
        xy = column array with global mesh, length: noe=nov(npdx*npdy,ne)
        ww = column array with global weigths, length: noe=nov(npdx*npdy,ne)
             diag(ww) is the mass matrix associated to SEM discretization
        nov = local -global map, previously generated by cosnov_2d
        u = numerical solution
        n_int = number of nodes in each element to interpolate numerical
        solution by Level_0/legendre_tr_eval.m (Discrete Legendre Transform)

 Output: ha=gca of figure fig</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../Src/Level_0/legendre_tr_eval.html" class="code" title="function [u_int]=legendre_tr_eval(x,u,x_int);">legendre_tr_eval</a>	LEGENDRE_TR_EVAL     Evaluates Discrete Legendre Transform</li><li><a href="../../Src/Level_0/xwlgl.html" class="code" title="function [x,w] = xwlgl(np,a,b)">xwlgl</a>	XWLGL Computes nodes and weights of the Legendre-Gauss-Lobatto quadrature formula.</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../Src/Elliptic_2d/Schwarz/schwarz_2d.html" class="code" title="function [xy,un,param]=schwarz_2d(xa,xb,ya,yb,gam,uex,uex_x,uex_y,ff,g,h,cb,nex,nx,ney,ny,gammax,gammay,param);">schwarz_2d</a>	SCHWARZ_2D   Numerical solution of the 2D boundary value problem</li><li><a href="../../Src/Elliptic_2d/lap_2d.html" class="code" title="function [xy,un,D,param]=lap_2d(xa,xb,ya,yb,gam,uex,uex_x,uex_y,ff,g,h,cb,nex,nx,ney,ny,gammax,gammay,param);">lap_2d</a>	LAP_2D   Numerical solution of the 2D b.v.p. -Delta u + gam u = f</li></ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [ha]=plot_sem_2d(fig,command,nex,ney,x,xx,jacx,y,yy,jacy,xy,ww,nov,</a><span class="keyword">...</span>
0002     u,n_int);
0003 <span class="comment">% PLOT_SEM_2D Plots SEM numerical solution of 2D boundary value problems</span>
0004 <span class="comment">%</span>
0005 <span class="comment">%  [ha]=plot_sem_2d(fig,command,nex,ney,x,xx,jacx,y,yy,jacy,xy,ww,nov,...</span>
0006 <span class="comment">%    u,n_int);</span>
0007 <span class="comment">%</span>
0008 <span class="comment">% Input: fig =  figure number, set in the colling function by figure</span>
0009 <span class="comment">%                command</span>
0010 <span class="comment">%        command = either 'mesh', 'surf' or 'contour'</span>
0011 <span class="comment">%        nex = number of Spectral elements along x-direction</span>
0012 <span class="comment">%        ney = number of Spectral elements along y-direction</span>
0013 <span class="comment">%        x = LGL nodes in [-1,1] along x-direction</span>
0014 <span class="comment">%        xx = 2-indexes array of size (4,ne)</span>
0015 <span class="comment">%            xx(1:4,ie)=[x_V1_ie;x_V2_ie;x_V3_ie;x_V4_ie]</span>
0016 <span class="comment">%            (ne=nex*ney is the global number of spectral elements)</span>
0017 <span class="comment">%        jacx = array (length(jacx)=ne); jacx(ie)= (x_V2_ie-x_V1_ie)/2</span>
0018 <span class="comment">%        y = LGL nodes in [-1,1] along y-direction</span>
0019 <span class="comment">%        yy = 2-indexes array of size (4,ne)</span>
0020 <span class="comment">%            yy(1:4,ie)=[y_V1_ie;y_V2_ie;y_V3_ie;y_V4_ie]</span>
0021 <span class="comment">%            (ne=nex*ney is the global number of spectral elements)</span>
0022 <span class="comment">%        jacy = array (length(jacy)=ne); jacy(ie)= (y_V3_ie-y_V1_ie)/2</span>
0023 <span class="comment">%        xy = column array with global mesh, length: noe=nov(npdx*npdy,ne)</span>
0024 <span class="comment">%        ww = column array with global weigths, length: noe=nov(npdx*npdy,ne)</span>
0025 <span class="comment">%             diag(ww) is the mass matrix associated to SEM discretization</span>
0026 <span class="comment">%        nov = local -global map, previously generated by cosnov_2d</span>
0027 <span class="comment">%        u = numerical solution</span>
0028 <span class="comment">%        n_int = number of nodes in each element to interpolate numerical</span>
0029 <span class="comment">%        solution by Level_0/legendre_tr_eval.m (Discrete Legendre Transform)</span>
0030 <span class="comment">%</span>
0031 <span class="comment">% Output: ha=gca of figure fig</span>
0032 
0033 <span class="comment">%   Written by Paola Gervasio</span>
0034 <span class="comment">%   $Date: 2007/04/01$</span>
0035 
0036 <span class="comment">%</span>
0037 <span class="comment">%</span>
0038 <span class="comment">%</span>
0039 npdx=length(x);
0040 npdy=length(y);
0041 npdx1=n_int; npdy1=npdx1;
0042 hf=figure(fig);clf
0043 axis([min(xy(:,1)),max(xy(:,1)),min(xy(:,2)),max(xy(:,2))]);hold on
0044 ne=nex*ney;
0045 
0046 <span class="keyword">if</span> nargin ==16
0047     <span class="comment">% plot without interpolating</span>
0048     cmin=min(u);cmax=max(u);
0049     caxis([cmin,cmax])
0050 
0051 <span class="keyword">for</span> ie=1:ne
0052     mn=npdx*npdy;
0053     ctx=jacx(ie)*x+0.5*(xx(2,ie)+xx(1,ie));
0054     cty=jacy(ie)*y+0.5*(yy(3,ie)+yy(1,ie));
0055     clear uloc;
0056     uloc=reshape(u(nov(1:mn,ie)),npdx,npdy);
0057     <span class="keyword">if</span> command(1,1)==<span class="string">'c'</span>
0058         contour(ctx,cty,uloc',35);
0059     <span class="keyword">else</span>
0060     eval([command,<span class="string">'(ctx,cty,uloc'')'</span>]); 
0061     <span class="keyword">end</span>
0062     
0063 <span class="keyword">end</span>    
0064 ha=gca;
0065 <span class="keyword">if</span> command(1,1)~=<span class="string">'c'</span>
0066 set(ha,<span class="string">'view'</span>,[-36,34]);
0067 <span class="keyword">end</span>
0068 <span class="keyword">else</span>
0069     
0070 <span class="comment">% plot with interpolation</span>
0071 
0072     u_int=zeros(npdy1,npdx1,ne);
0073  
0074 <span class="keyword">for</span> ie=1:ne
0075     mn=npdx*npdy;
0076     
0077 x1=<a href="../../Src/Level_0/xwlgl.html" class="code" title="function [x,w] = xwlgl(np,a,b)">xwlgl</a>(npdx1); y1=<a href="../../Src/Level_0/xwlgl.html" class="code" title="function [x,w] = xwlgl(np,a,b)">xwlgl</a>(npdy1);
0078 
0079 uloc=reshape(u(nov(1:mn,ie)),npdx,npdy);
0080 [u1x]=<a href="../../Src/Level_0/legendre_tr_eval.html" class="code" title="function [u_int]=legendre_tr_eval(x,u,x_int);">legendre_tr_eval</a>(x,uloc,x1);
0081 [u1y]=<a href="../../Src/Level_0/legendre_tr_eval.html" class="code" title="function [u_int]=legendre_tr_eval(x,u,x_int);">legendre_tr_eval</a>(y,u1x',y1);
0082     
0083 u_int(:,:,ie)=u1y;
0084 <span class="keyword">if</span> command(1,1)~=<span class="string">'c'</span>
0085     ctx=jacx(ie)*x1+0.5*(xx(2,ie)+xx(1,ie));
0086 cty=jacy(ie)*y1+0.5*(yy(3,ie)+yy(1,ie));
0087 eval([command,<span class="string">'(ctx,cty,u1y)'</span>]);hold on
0088 <span class="comment">%axis([-1,1,-1,1])</span>
0089 alpha(1)
0090 <span class="keyword">end</span>
0091  
0092 <span class="keyword">end</span>
0093 ha=gca;
0094 set(ha,<span class="string">'Fontname'</span>,<span class="string">'Times'</span>,<span class="keyword">...</span>
0095     <span class="string">'FontSize'</span>,16,<span class="keyword">...</span>
0096     <span class="string">'Xgrid'</span>,<span class="string">'on'</span>,<span class="string">'YGrid'</span>,<span class="string">'on'</span>,<span class="string">'Linewidth'</span>,2);
0097 
0098 <span class="keyword">if</span> command(1,1)~=<span class="string">'c'</span>
0099     set(ha,<span class="string">'view'</span>,[-36,34])
0100 <span class="keyword">else</span>
0101     cmin=min(min(min(u_int)));
0102     cmax=max(max(max(u_int)));
0103     caxis([cmin,cmax]);
0104     V=linspace(cmin,cmax,35);
0105     <span class="keyword">for</span> ie=1:ne
0106     ctx=jacx(ie)*x1+0.5*(xx(2,ie)+xx(1,ie));
0107     cty=jacy(ie)*y1+0.5*(yy(3,ie)+yy(1,ie));
0108     u1=u_int(:,:,ie);
0109     
0110     contour(ctx,cty,u1,V,<span class="string">'LineWidth'</span>,2);
0111     <span class="keyword">end</span>
0112 <span class="keyword">end</span>
0113 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Fri 21-Sep-2007 10:07:00 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>